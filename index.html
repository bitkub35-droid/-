<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ï‡∏á‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô‡∏£‡∏ñ‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@300;400;500;600;700&family=Kanit:wght@200;300;400;500;600&display=swap');
        
        :root {
            --tong-red: #dc2626;
            --tong-dark: #111827;
        }
        /* Background Color */
        body { 
            font-family: 'Kanit', sans-serif; 
             /*background-color: #220a0a; 
            background: linear-gradient(135deg, #080404 0%,#6b1414 50%, #520c0c 75%, #0e0303 100%);           
            background: linear-gradient(135deg, #0f0505 0%, #4a0a0a 45%, #2b0606 75%, #080404 100%);*/
             background: linear-gradient(180deg, #1a0505 10%, #000000 100%);
            color: #1f2937;
        }

        /*body {
            font-family: 'Kanit', sans-serif;
             ‡πÑ‡∏•‡πà‡∏à‡∏≤‡∏Å‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á‡πÄ‡∏Ç‡πâ‡∏°‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡πÅ‡∏î‡∏á‡πÄ‡∏Ç‡πâ‡∏° ‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏´‡∏£‡∏π‡∏´‡∏£‡∏≤ 
            background: linear-gradient(135deg, #080404 0%, #4a0e0e 100%);
            color: #ffffff; /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡∏ä‡∏±‡∏î‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏° 
            min-height: 100-vh;
            margin: 0;
    }*/

        .heading-font { font-family: 'Chakra Petch', sans-serif; }

        .btn-red {
            background-color: var(--tong-red);
            color: white;
            transition: all 0.2s ease;
        }
        .btn-red:hover {
            background-color: #b91c1c;
            transform: translateY(-1px);
        }

        .header-sticky {
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .bike-card {
            transition: all 0.3s ease;
        }
        .bike-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .image-upload-box {
            border: 2px dashed #d1d5db;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .image-upload-box:hover {
            border-color: var(--tong-red);
            background-color: #fef2f2;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }

        @media print {
            .no-print { display: none !important; }
            body { background: white; padding: 0; }
            #receipt-template { display: block !important; width: 100%; position: absolute; top: 0; left: 0; }
        }
    </style>
</head>
<body class="min-h-screen pb-10">

    <!-- Header & Dashboard -->
    <div class="no-print header-sticky">
        <header class="bg-gray-900 text-white border-b-4 border-red-600 shadow-xl">
            <div class="container mx-auto px-4 py-3 flex justify-between items-center">
                <div class="flex items-center space-x-3 cursor-pointer" onclick="location.reload()">
                    <div class="bg-red-600 p-2 rounded transform -skew-x-12">
                        <i class="fas fa-motorcycle text-2xl"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-black heading-font italic leading-none uppercase tracking-tighter">Tong Motor</h1>
                        <p class="text-[9px] text-red-500 font-bold uppercase tracking-widest">‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏ï‡∏á‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå</p>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <button id="viewToggleBtn" onclick="toggleView()" class="bg-gray-800 text-yellow-400 font-bold px-3 py-2 rounded-xl text-xs flex items-center border border-yellow-400/30 hover:bg-gray-700 transition">
                        <i id="viewIcon" class="fas fa-table mr-2"></i>
                        <span id="viewLabel">‡∏™‡∏•‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á</span>
                    </button>
                    
                    <button onclick="exportData()" title="‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•" class="bg-gray-800 text-gray-400 p-2 rounded-lg hover:text-white transition border border-gray-700">
                        <i class="fas fa-cloud-download-alt"></i>
                    </button>
                    <button onclick="toggleModal('addModal')" class="btn-red px-5 py-2 rounded-xl font-bold text-sm shadow-lg flex items-center">
                        <i class="fas fa-plus-circle mr-2"></i> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà
                    </button>
                </div>
            </div>
        </header>

        <!-- Stats Bar -->
        <div class="bg-white border-b shadow-sm"> 
            <div class="container mx-auto px-4 py-3">
                <div class="grid grid-cols-4 gap-4">
                    <div class="text-center md:text-left border-r border-gray-100 last:border-0">
                        <p class="text-[10px] text-gray-800 font-bold uppercase">‡∏£‡∏ñ‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å</p>
                        <h3 id="stat-total" class="text-2xl font-black heading-font tracking-tight">0</h3>
                    </div>
                    <div class="text-center md:text-left border-r border-gray-100 last:border-0">
                        <p class="text-[10px] text-gray-800 font-bold uppercase">‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</p>
                        <h3 id="stat-sold" class="text-2xl font-black heading-font text-green-600 tracking-tight">0</h3>
                    </div>
                    <div class="text-center md:text-left border-r border-gray-100 last:border-0">
                        <p class="text-[10px] text-gray-800 font-bold uppercase">‡∏£‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</p>
                        <h3 id="stat-docs" class="text-2xl font-black heading-font text-yellow-600 tracking-tight">0</h3>
                    </div>
                    <div class="text-center md:text-left">
                        <p class="text-[10px] text-red-800 font-bold uppercase">‡∏Å‡∏≥‡πÑ‡∏£‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                        <h3 id="stat-profit" class="text-2xl font-black heading-font tracking-tighter italic text-red-700">‡∏ø0</h3>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content Area -->
    <main class="container mx-auto px-4 mt-6 no-print">
        <div class="flex flex-col md:flex-row gap-3 mb-6">
            <div class="relative flex-grow">
                <input type="text" id="searchInput" onkeyup="renderCurrentView()" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏∏‡πà‡∏ô‡∏£‡∏ñ, ‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô, ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤..." 
                    class="w-full pl-11 pr-4 py-3 bg-white border rounded-2xl shadow-sm focus:ring-2 focus:ring-red-500 outline-none transition-all">
                <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-300"></i>
            </div>
            <select id="filterStatus" onchange="renderCurrentView()" class="bg-white px-4 py-2 rounded-2xl shadow-sm font-bold text-gray-700 border outline-none cursor-pointer">
                <option value="all">‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏ñ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                <option value="available">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≤‡∏¢</option>
                <option value="sold">‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß</option>
            </select>
        </div>

        <div id="gridView" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>

        <div id="tableView" class="hidden bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
            <div class="overflow-x-auto">
                <table class="w-full text-left text-sm">
                    <thead class="bg-gray-900 text-white text-[10px] uppercase tracking-wider font-bold">
                        <tr>
                            <th class="p-10">           ‡∏£‡∏π‡∏õ</th>
                            <th class="p-10">‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠/‡∏£‡∏∏‡πà‡∏ô</th>
                            <th class="p-8">‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</th>
                            <th class="p-8 text-right">‡∏ó‡∏∏‡∏ô</th>
                            <th class="p-8 text-right">‡∏Ç‡∏≤‡∏¢</th>
                            <th class="p-8 text-right">‡∏Å‡∏≥‡πÑ‡∏£</th>
                            <th class="p-4 text-center">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</th>
                            <th class="p-4 text-center">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th class="p-4 text-center">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody" class="divide-y divide-gray-100"></tbody>
                </table>
            </div>
        </div>
    </main>

    <!-- Modal: Add/Edit -->
    <div id="addModal" class="fixed inset-0 bg-black/80 backdrop-blur-md hidden z-[100] flex items-center justify-center p-4 no-print">
        <div class="bg-white w-full max-w-2xl rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col max-h-[95vh]">
            <div class="p-6 bg-gray-900 text-white flex justify-between items-center border-b-4 border-red-600">
                <h2 id="modalTitle" class="text-xl font-bold heading-font italic">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏ñ ‡∏ï‡∏á‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå</h2>
                <button onclick="toggleModal('addModal')" class="bg-gray-800 text-gray-400 hover:text-white w-10 h-10 rounded-full flex items-center justify-center transition">&times;</button>
            </div>
            
            <div class="p-8 overflow-y-auto">
                <form id="bikeForm" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <input type="hidden" id="editIndex">
                    
                    <div class="md:col-span-2">
                        <label class="block text-[10px] font-bold text-gray-400 mb-2 uppercase">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ñ</label>
                        <div onclick="document.getElementById('fileInput').click()" class="image-upload-box rounded-3xl h-48 flex flex-col items-center justify-center overflow-hidden relative group">
                            <img id="imagePreview" src="" class="hidden w-full h-full object-cover">
                            <div id="uploadPlaceholder" class="text-center group-hover:scale-110 transition">
                                <i class="fas fa-camera text-4xl text-gray-300 mb-2"></i>
                                <p class="text-[10px] text-gray-400 uppercase font-bold">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏ñ</p>
                            </div>
                            <input type="file" id="fileInput" accept="image/*" class="hidden" onchange="previewImage(this)">
                            <textarea id="base64Store" class="hidden"></textarea>
                        </div>
                    </div>

                    <div class="md:col-span-2">
                        <label class="block text-[10px] font-bold text-gray-400 mb-1 uppercase">‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠ / ‡∏£‡∏∏‡πà‡∏ô‡∏£‡∏ñ</label>
                        <input type="text" id="model" required placeholder="‡πÄ‡∏ä‡πà‡∏ô Honda Forza 350" class="w-full p-4 bg-gray-50 border-2 border-gray-100 rounded-2xl outline-none focus:border-red-500 transition-all font-bold">
                    </div>

                    <div>
                        <label class="block text-[10px] font-bold text-gray-400 mb-1 uppercase">‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</label>
                        <input type="text" id="plate" placeholder="1‡∏Å‡∏Ç 1234 ‡∏Å‡∏ó‡∏°" class="w-full p-4 bg-gray-50 border-2 border-gray-100 rounded-2xl outline-none focus:border-red-500">
                    </div>
                    <div>
                        <label class="block text-[10px] font-bold text-gray-400 mb-1 uppercase">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ã‡∏∑‡πâ‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤</label>
                        <input type="date" id="buyDate" required class="w-full p-4 bg-gray-50 border-2 border-gray-100 rounded-2xl outline-none">
                    </div>
                    <div>
                        <label class="block text-[10px] font-bold text-gray-400 mb-1 uppercase">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ó‡∏∏‡∏ô</label>
                        <input type="number" id="costPrice" required placeholder="0" class="w-full p-4 bg-gray-50 border-2 border-gray-100 rounded-2xl outline-none text-red-600 font-black text-lg">
                    </div>
                    <div>
                        <label class="block text-[10px] font-bold text-gray-400 mb-1 uppercase">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≤‡∏¢</label>
                        <input type="number" id="salePrice" required placeholder="0" class="w-full p-4 bg-gray-50 border-2 border-gray-100 rounded-2xl outline-none text-green-600 font-black text-lg">
                    </div>
                    <div>
                        <label class="block text-[10px] font-bold text-gray-400 mb-1 uppercase">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏°‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</label>
                        <select id="docStatus" class="w-full p-4 bg-gray-50 border-2 border-gray-100 rounded-2xl outline-none font-bold">
                            <option value="‡∏Ñ‡∏£‡∏ö">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Ñ‡∏£‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÇ‡∏≠‡∏ô</option>
                            <option value="‡∏£‡∏≠‡πÄ‡∏•‡πà‡∏°">‡∏£‡∏≠‡πÄ‡∏•‡πà‡∏°‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</option>
                            <option value="‡∏£‡∏≠‡∏ä‡∏∏‡∏î‡πÇ‡∏≠‡∏ô">‡∏£‡∏≠‡∏ä‡∏∏‡∏î‡πÇ‡∏≠‡∏ô</option>
                            <option value="‡∏Ç‡∏≤‡∏î‡∏ï‡πà‡∏≠">‡∏†‡∏≤‡∏©‡∏µ‡∏Ç‡∏≤‡∏î‡∏ï‡πà‡∏≠</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-[10px] font-bold text-gray-400 mb-1 uppercase">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</label>
                        <select id="status" onchange="toggleSaleFields()" class="w-full p-4 border-2 border-gray-200 rounded-2xl outline-none font-black text-red-600">
                            <option value="available">‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≤‡∏¢ (Available)</option>
                            <option value="sold">‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß (Sold Out)</option>
                        </select>
                    </div>

                    <!-- Sold Info Section -->
                    <div id="soldFields" class="hidden md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4 bg-red-50 p-6 rounded-3xl border-2 border-red-100">
                        <div class="md:col-span-2 flex items-center mb-2">
                            <i class="fas fa-handshake text-red-600 mr-2"></i>
                            <h3 class="font-bold text-red-600 text-xs uppercase tracking-wider">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢</h3>
                        </div>
                        <input type="text" id="customerName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤" class="w-full p-4 bg-white border border-red-200 rounded-2xl outline-none">
                        <input type="text" id="customerPhone" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠" class="w-full p-4 bg-white border border-red-200 rounded-2xl outline-none">
                        <input type="date" id="sellDate" class="w-full p-4 bg-white border border-red-200 rounded-2xl outline-none">
                        <select id="paymentType" class="w-full p-4 bg-white border border-red-200 rounded-2xl outline-none font-bold">
                            <option value="‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</option>
                            <option value="‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô">‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</option>
                            <option value="‡∏à‡∏±‡∏î‡πÑ‡∏ü‡πÅ‡∏ô‡∏ô‡∏ã‡πå">‡∏à‡∏±‡∏î‡πÑ‡∏ü‡πÅ‡∏ô‡∏ô‡∏ã‡πå</option>
                            <option value="‡∏°‡∏±‡∏î‡∏à‡∏≥">‡∏ß‡∏≤‡∏á‡∏°‡∏±‡∏î‡∏à‡∏≥</option>
                        </select>
                    </div>

                    <div class="md:col-span-2 pt-4">
                        <button type="submit" class="w-full btn-red py-5 rounded-2xl font-black text-xl heading-font shadow-xl uppercase tracking-widest">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏£‡∏∞‡∏ö‡∏ö</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Receipt Template (Hidden) -->
    <div id="receipt-template" class="hidden p-8 bg-white text-black min-h-screen">
        <div class="max-w-[800px] mx-auto border-8 border-double border-black p-8 relative">
            <div class="text-center mb-10">
                <h1 class="text-5xl font-black heading-font italic uppercase tracking-tighter mb-2">TONG MOTOR</h1>
                <p class="text-lg font-bold">‡∏ï‡∏á‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå ‡∏£‡∏ñ‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô‡∏¢‡∏ô‡∏ï‡πå‡∏°‡∏∑‡∏≠‡∏™‡∏≠‡∏á‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏≠</p>
                <div class="h-1 bg-red-600 w-48 mx-auto my-4"></div>
                <p class="text-xs">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà 13 ‡∏ñ‡∏ô‡∏ô‡∏ß‡∏¥‡∏ë‡∏π‡∏£‡∏≠‡∏∏‡∏ó‡∏¥‡∏®1 ‡∏ï‡∏≥‡∏ö‡∏•‡∏™‡∏∞‡πÄ‡∏ï‡∏á ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏¢‡∏∞‡∏•‡∏≤ ‡∏¢‡∏∞‡∏•‡∏≤ 95000</p>
                <p class="text-xs">‡πÇ‡∏ó‡∏£: 081-959-9480 | Line: @tongmotor</p>
            </div>

            <div class="flex justify-between items-end border-b-2 border-black pb-4 mb-8">
                <div>
                    <h2 class="text-2xl font-bold uppercase underline">‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô / ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢</h2>
                    <p class="mt-2 text-sm">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£: <span id="r-id" class="font-bold"></span></p>
                </div>
                <div class="text-right">
                    <p class="text-sm">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£: <span id="r-date" class="font-bold"></span></p>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-10 mb-10">
                <div class="border p-4 rounded-lg bg-gray-50">
                    <p class="text-[10px] font-bold text-gray-500 uppercase mb-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏ã‡∏∑‡πâ‡∏≠</p>
                    <p class="text-xl font-bold" id="r-customer"></p>
                    <p class="text-sm text-gray-700" id="r-phone"></p>
                </div>
                <div class="text-right">
                    <p class="text-[10px] font-bold text-gray-500 uppercase mb-1">‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô</p>
                    <p class="text-5xl font-black text-red-600 italic">‡∏ø<span id="r-price"></span></p>
                    <p class="text-[10px] text-gray-400 mt-1 italic" id="r-payment"></p>
                </div>
            </div>

            <table class="w-full mb-12 border-collapse">
                <thead>
                    <tr class="bg-black text-white">
                        <th class="p-3 text-left">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                        <th class="p-3 text-center">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</th>
                        <th class="p-3 text-right">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="p-5 border-b border-black">
                            <p class="font-black text-xl italic uppercase" id="r-model"></p>
                            <p class="text-xs text-gray-500 mt-1">‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏¢‡∏ô‡∏ï‡πå‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ 1 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</p>
                        </td>
                        <td class="p-5 border-b border-black text-center font-bold text-lg" id="r-plate"></td>
                        <td class="p-5 border-b border-black text-right font-black text-xl">‡∏ø<span id="r-total"></span></td>
                    </tr>
                </tbody>
            </table>

            <div class="grid grid-cols-2 gap-20 mt-20">
                <div class="text-center">
                    <div class="w-full border-b-2 border-black mb-4 h-10"></div>
                    <p class="font-bold">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠ ............................................................</p>
                    <p class="text-xs uppercase mt-1">‡∏ú‡∏π‡πâ‡∏ã‡∏∑‡πâ‡∏≠ (Buyer)</p>
                </div>
                <div class="text-center">
                    <div class="w-full border-b-2 border-black mb-4 h-10"></div>
                    <p class="font-bold">‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠ ............................................................</p>
                    <p class="text-xs uppercase mt-1 font-bold text-red-600">‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢ / ‡∏ï‡∏á‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå (Seller)</p>
                </div>
            </div>

            <div class="mt-20 border-t pt-4 text-center">
                <p class="text-[9px] text-gray-400 italic">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÑ‡∏ß‡πâ‡∏ß‡∏≤‡∏á‡πÉ‡∏à ‡∏ï‡∏á‡∏°‡∏≠‡πÄ‡∏ï‡∏≠‡∏£‡πå "‡∏£‡∏ñ‡∏î‡∏µ ‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏¢‡∏∏‡∏ï‡∏¥‡∏ò‡∏£‡∏£‡∏°"</p>
            </div>
        </div>
        <div class="text-center mt-6 no-print">
            <button onclick="window.print()" class="bg-black text-white px-10 py-4 rounded-full font-bold shadow-lg hover:scale-105 transition">‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (Print)</button>
            <button onclick="location.reload()" class="ml-4 text-gray-500 font-bold hover:underline">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
        </div>
    </div>

    <script>
        // Use versioning for storage
        const DB_KEY = 'tong_motor_v3_premium';
        let inventory = JSON.parse(localStorage.getItem(DB_KEY)) || [];
        let currentMode = 'grid';

        function previewImage(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const preview = document.getElementById('imagePreview');
                    const placeholder = document.getElementById('uploadPlaceholder');
                    const base64Store = document.getElementById('base64Store');
                    preview.src = e.target.result;
                    preview.classList.remove('hidden');
                    placeholder.classList.add('hidden');
                    base64Store.value = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function toggleView() {
            currentMode = currentMode === 'grid' ? 'table' : 'grid';
            const grid = document.getElementById('gridView');
            const table = document.getElementById('tableView');
            const label = document.getElementById('viewLabel');
            const icon = document.getElementById('viewIcon');

            if(currentMode === 'table') {
                grid.classList.add('hidden');
                table.classList.remove('hidden');
                label.innerText = '‡∏™‡∏•‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô';
                icon.className = 'fas fa-th-large mr-2';
            } else {
                grid.classList.remove('hidden');
                table.classList.add('hidden');
                label.innerText = '‡∏™‡∏•‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á';
                icon.className = 'fas fa-table mr-2';
            }
            renderCurrentView();
        }

        function toggleModal(id) {
            const m = document.getElementById(id);
            m.classList.toggle('hidden');
            if(m.classList.contains('hidden')) {
                document.getElementById('bikeForm').reset();
                document.getElementById('editIndex').value = '';
                document.getElementById('imagePreview').classList.add('hidden');
                document.getElementById('uploadPlaceholder').classList.remove('hidden');
                document.getElementById('base64Store').value = '';
                toggleSaleFields();
            }
        }

        function toggleSaleFields() {
            const status = document.getElementById('status').value;
            const fields = document.getElementById('soldFields');
            status === 'sold' ? fields.classList.remove('hidden') : fields.classList.add('hidden');
        }

        document.getElementById('bikeForm').onsubmit = function(e) {
            e.preventDefault();
            const fallbackImg = 'https://images.unsplash.com/photo-1558981403-c5f91cbba527?auto=format&fit=crop&q=80&w=600';
            const imgData = document.getElementById('base64Store').value || fallbackImg;

            const data = {
                id: document.getElementById('editIndex').value !== '' 
                    ? inventory[document.getElementById('editIndex').value].id 
                    : 'TM-' + Date.now().toString().slice(-4),
                model: document.getElementById('model').value,
                plate: document.getElementById('plate').value,
                buyDate: document.getElementById('buyDate').value,
                costPrice: parseFloat(document.getElementById('costPrice').value),
                salePrice: parseFloat(document.getElementById('salePrice').value),
                docStatus: document.getElementById('docStatus').value,
                status: document.getElementById('status').value,
                img: imgData,
                customerName: document.getElementById('customerName').value,
                customerPhone: document.getElementById('customerPhone').value,
                sellDate: document.getElementById('sellDate').value,
                paymentType: document.getElementById('paymentType').value,
            };

            const idx = document.getElementById('editIndex').value;
            if(idx !== '') inventory[idx] = data;
            else inventory.unshift(data);
            
            save();
            toggleModal('addModal');
        };

        function deleteBike(index) {
            if(confirm('üö® ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏ñ‡∏Ñ‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö? (‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ)')) {
                inventory.splice(index, 1);
                save();
            }
        }

        function editBike(index) {
            const b = inventory[index];
            document.getElementById('editIndex').value = index;
            document.getElementById('model').value = b.model;
            document.getElementById('plate').value = b.plate;
            document.getElementById('buyDate').value = b.buyDate;
            document.getElementById('costPrice').value = b.costPrice;
            document.getElementById('salePrice').value = b.salePrice;
            document.getElementById('docStatus').value = b.docStatus;
            document.getElementById('status').value = b.status;
            
            if(b.img) {
                const preview = document.getElementById('imagePreview');
                const placeholder = document.getElementById('uploadPlaceholder');
                preview.src = b.img;
                preview.classList.remove('hidden');
                placeholder.classList.add('hidden');
                document.getElementById('base64Store').value = b.img;
            }

            document.getElementById('customerName').value = b.customerName || '';
            document.getElementById('customerPhone').value = b.customerPhone || '';
            document.getElementById('sellDate').value = b.sellDate || '';
            document.getElementById('paymentType').value = b.paymentType || '‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î';
            
            toggleModal('addModal');
            toggleSaleFields();
        }

        function showReceipt(index) {
            const b = inventory[index];
            document.getElementById('r-id').innerText = b.id;
            document.getElementById('r-customer').innerText = b.customerName || '‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ';
            document.getElementById('r-phone').innerText = '‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠: ' + (b.customerPhone || '-');
            document.getElementById('r-price').innerText = b.salePrice.toLocaleString();
            document.getElementById('r-total').innerText = b.salePrice.toLocaleString();
            document.getElementById('r-model').innerText = b.model;
            document.getElementById('r-plate').innerText = b.plate || '-';
            document.getElementById('r-payment').innerText = '‡∏ä‡∏≥‡∏£‡∏∞‡πÇ‡∏î‡∏¢: ' + b.paymentType;
            document.getElementById('r-date').innerText = b.sellDate ? new Date(b.sellDate).toLocaleDateString('th-TH') : new Date().toLocaleDateString('th-TH');
            
            document.querySelector('main').classList.add('hidden');
            document.querySelector('.header-sticky').classList.add('hidden');
            document.getElementById('receipt-template').classList.remove('hidden');
            window.scrollTo(0, 0);
        }

        function exportData() {
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(inventory));
            const dl = document.createElement('a');
            dl.setAttribute("href", dataStr);
            dl.setAttribute("download", `tong_motor_backup_${new Date().toISOString().slice(0,10)}.json`);
            dl.click();
        }

        function save() {
            try {
                localStorage.setItem(DB_KEY, JSON.stringify(inventory));
                renderCurrentView();
                updateStats();
            } catch (e) {
                alert("‚ö†Ô∏è ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏ï‡πá‡∏°! ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡∏•‡∏ö‡∏£‡∏π‡∏õ‡πÄ‡∏Å‡πà‡∏≤‡∏≠‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• JSON ‡πÑ‡∏ß‡πâ‡∏Ñ‡∏£‡∏±‡∏ö");
            }
        }

        function updateStats() {
            const available = inventory.filter(b => b.status === 'available').length;
            const soldCount = inventory.filter(b => b.status === 'sold').length;
            const docsCount = inventory.filter(b => b.docStatus !== '‡∏Ñ‡∏£‡∏ö').length;
            const profit = inventory.reduce((acc, b) => b.status === 'sold' ? acc + (b.salePrice - b.costPrice) : acc, 0);

            document.getElementById('stat-total').innerText = available;
            document.getElementById('stat-sold').innerText = soldCount;
            document.getElementById('stat-docs').innerText = docsCount;
            document.getElementById('stat-profit').innerText = "‡∏ø" + profit.toLocaleString();
        }

        function renderCurrentView() {
            if(currentMode === 'grid') renderGrid();
            else renderTable();
        }

        function renderGrid() {
            const container = document.getElementById('gridView');
            const search = document.getElementById('searchInput').value.toLowerCase();
            const filter = document.getElementById('filterStatus').value;
            container.innerHTML = '';

            inventory.forEach((b, index) => {
                const searchStr = (b.model + b.plate + (b.customerName||'')).toLowerCase();
                if(!searchStr.includes(search)) return;
                if(filter !== 'all' && b.status !== filter) return;

                container.innerHTML += `
                    <div class="bg-white rounded-[2rem] overflow-hidden shadow-sm border border-gray-100 bike-card flex flex-col h-full">
                        <div class="h-48 overflow-hidden relative">
                            <img src="${b.img}" class="w-full h-full object-cover">
                            <div class="absolute top-4 left-4 flex flex-col gap-2">
                                <span class="text-[9px] font-black px-2 py-1 rounded-lg bg-black/70 text-white backdrop-blur-md uppercase tracking-widest">${b.id}</span>
                                <span class="text-[9px] font-black px-2 py-1 rounded-lg shadow-lg text-white uppercase ${b.status === 'available' ? 'bg-blue-600' : 'bg-green-600'}">
                                    ${b.status === 'available' ? '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡∏≤‡∏¢' : '‡∏Ç‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß'}
                                </span>
                            </div>
                        </div>
                        <div class="p-5 flex-grow">
                            <div class="flex justify-between items-start mb-1">
                                <h3 class="font-black text-sm uppercase italic tracking-tighter truncate w-3/4">${b.model}</h3>
                                <span class="text-[9px] font-bold text-gray-400 bg-gray-100 px-2 py-0.5 rounded">${b.docStatus}</span>
                            </div>
                            <p class="text-xs text-red-600 font-bold mb-4">${b.plate || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô'}</p>
                            <div class="flex items-baseline gap-1">
                                <span class="text-2xl font-black italic tracking-tighter">‡∏ø${b.salePrice.toLocaleString()}</span>
                               <span class="text-[15px] text-gray-800 font-bold uppercase">  ‡∏ö‡∏≤‡∏ó   </span> 
                            </div>
                        </div>
                        <div class="p-3 grid grid-cols-2 gap-2 border-t bg-gray-50/50">
                            ${b.status === 'sold' 
                                ? `<button onclick="showReceipt(${index})" class="bg-black text-white py-2.5 rounded-xl text-[10px] font-bold shadow-md hover:bg-gray-800 transition">‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</button>` 
                                : `<button onclick="editBike(${index})" class="bg-white border-2 border-gray-200 text-gray-700 py-2.5 rounded-xl text-[10px] font-bold hover:bg-gray-100 transition">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>`
                            }
                            <div class="flex gap-1">
                                ${b.status === 'sold' ? `<button onclick="editBike(${index})" class="flex-1 bg-white border text-gray-400 rounded-xl text-[10px]"><i class="fas fa-edit"></i></button>` : ''}
                                <button onclick="deleteBike(${index})" class="flex-1 bg-red-50 text-red-300 hover:text-red-500 rounded-xl transition"><i class="fas fa-trash-alt text-xs"></i></button>
                            </div>
                        </div>
                    </div>
                `;
            });
            if(inventory.length === 0) {
                container.innerHTML = `<div class="col-span-full py-20 text-center"><i class="fas fa-motorcycle text-6xl text-gray-200 mb-4"></i><p class="text-gray-400 font-bold">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏ñ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p></div>`;
            }
        }

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            const search = document.getElementById('searchInput').value.toLowerCase();
            const filter = document.getElementById('filterStatus').value;
            tbody.innerHTML = '';

            inventory.forEach((b, index) => {
                const searchStr = (b.model + b.plate + (b.customerName||'')).toLowerCase();
                if(!searchStr.includes(search)) return;
                if(filter !== 'all' && b.status !== filter) return;

                const profit = b.status === 'sold' ? (b.salePrice - b.costPrice) : 0;

                tbody.innerHTML += `
                    <tr class="hover:bg-gray-50 transition border-b border-gray-50">
                        <td class="p-4"><img src="${b.img}" class="w-14 h-10 rounded-lg object-cover shadow-sm"></td>
                        <td class="p-4 font-black text-xs uppercase italic">
                            ${b.model}
                            <div class="text-[9px] text-gray-400 font-normal mt-0.5">ID: ${b.id}</div>
                        </td>
                        <td class="p-4 text-xs font-bold text-red-600">${b.plate || '-'}</td>
                        <td class="p-4 text-right font-bold text-xs">‡∏ø${b.costPrice.toLocaleString()}</td>
                        <td class="p-4 text-right font-bold text-xs">‡∏ø${b.salePrice.toLocaleString()}</td>
                        <td class="p-4 text-right font-black text-xs ${profit > 0 ? 'text-green-600' : 'text-gray-300'}">
                            ${profit > 0 ? '‡∏ø' + profit.toLocaleString() : '-'}
                        </td>
                        <td class="p-4 text-center text-[10px] font-bold italic">${b.docStatus}</td>
                        <td class="p-4 text-center">
                            <span class="px-2 py-1 rounded-md text-[9px] font-black uppercase text-white ${b.status === 'available' ? 'bg-blue-600' : 'bg-green-600'}">
                                ${b.status === 'available' ? 'STK' : 'SOLD'}
                            </span>
                        </td>
                        <td class="p-4 text-center">
                            <div class="flex justify-center gap-3">
                                <button onclick="editBike(${index})" class="text-blue-500 hover:text-blue-700 transition" title="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç"><i class="fas fa-edit"></i></button>
                                ${b.status === 'sold' ? `<button onclick="showReceipt(${index})" class="text-green-600 hover:text-green-800 transition" title="‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à"><i class="fas fa-file-invoice"></i></button>` : ''}
                                <button onclick="deleteBike(${index})" class="text-red-200 hover:text-red-500 transition" title="‡∏•‡∏ö"><i class="fas fa-trash"></i></button>
                            </div>
                        </td>
                    </tr>
                `;
            });
        }

        window.onload = () => {
            updateStats();
            renderGrid();
        };
    </script>
</body>
</html>